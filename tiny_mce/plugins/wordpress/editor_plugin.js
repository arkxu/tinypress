(function(){var h=tinymce.DOM;tinymce.create("tinymce.plugins.WordPress",{mceTout:0,init:function(a,d){var c=this,g=a.getParam("wordpress_adv_toolbar","toolbar2"),i=a.getParam("wordpress_adv_toolbar","toolbar3"),b=0,k,l;k='<img src="'+d+'/img/trans.gif" class="mceWPmore mceItemNoResize" title="'+a.getLang("wordpress.wp_more_alt")+'" />';l='<img src="'+d+'/img/trans.gif" class="mceWPnextpage mceItemNoResize" title="'+a.getLang("wordpress.wp_page_alt")+'" />';a.settings.wordpress_adv_hidden=1;a.onPostRender.add(function(){var j=
a.controlManager.get(g),e=a.controlManager.get(i);a.getParam("wordpress_adv_hidden",1)&&j&&(h.hide(j.id),h.hide(e.id),c._resizeIframe(a,g,28),c._resizeIframe(a,i,28))});a.addCommand("WP_More",function(){a.execCommand("mceInsertContent",0,k)});a.addCommand("WP_Page",function(){a.execCommand("mceInsertContent",0,l)});a.addCommand("WP_Help",function(){a.windowManager.open({url:tinymce.baseURL+"/wp-mce-help.php",width:450,height:420,inline:1})});a.addCommand("WP_Adv",function(){var j=a.controlManager,
e=j.get(g).id,f=j.get(i).id;if(!("undefined"==e||"undefined"==f))h.isHidden(e)&&h.isHidden(f)?(j.setActive("wp_adv",1),h.show(e),h.show(f),c._resizeIframe(a,g,-28),c._resizeIframe(a,i,-28),a.settings.wordpress_adv_hidden=0):(j.setActive("wp_adv",0),h.hide(e),h.hide(f),c._resizeIframe(a,g,28),c._resizeIframe(a,i,28),a.settings.wordpress_adv_hidden=1)});a.addButton("wp_more",{title:"wordpress.wp_more_desc",image:d+"/img/more.gif",cmd:"WP_More"});a.addButton("wp_page",{title:"wordpress.wp_page_desc",
image:d+"/img/page.gif",cmd:"WP_Page"});a.addButton("wp_help",{title:"wordpress.wp_help_desc",image:d+"/img/help.gif",cmd:"WP_Help"});a.addButton("wp_adv",{title:"wordpress.wp_adv_desc",image:d+"/img/toolbars.gif",cmd:"WP_Adv"});a.addButton("add_media",{title:"wordpress.add_media",image:d+"/img/media.gif",onclick:function(){tb_show("",tinymce.DOM.get("add_media").href);tinymce.DOM.setStyle(["TB_overlay","TB_window","TB_load"],"z-index","999999")}});a.addButton("add_image",{title:"wordpress.add_image",
image:d+"/img/image.gif",onclick:function(){tb_show("",tinymce.DOM.get("add_image").href);tinymce.DOM.setStyle(["TB_overlay","TB_window","TB_load"],"z-index","999999")}});a.addButton("add_video",{title:"wordpress.add_video",image:d+"/img/video.gif",onclick:function(){tb_show("",tinymce.DOM.get("add_video").href);tinymce.DOM.setStyle(["TB_overlay","TB_window","TB_load"],"z-index","999999")}});a.addButton("add_audio",{title:"wordpress.add_audio",image:d+"/img/audio.gif",onclick:function(){tb_show("",
tinymce.DOM.get("add_audio").href);tinymce.DOM.setStyle(["TB_overlay","TB_window","TB_load"],"z-index","999999")}});a.onBeforeExecCommand.add(function(a,e,f,d,b){var f=tinymce.DOM,c;"mceFullScreen"==e&&"mce_fullscreen"!=a.id&&f.get("add_audio")&&f.get("add_video")&&f.get("add_image")&&f.get("add_media")&&(a.settings.theme_advanced_buttons1+=",|,add_image,add_video,add_audio,add_media");if("JustifyLeft"==e||"JustifyRight"==e||"JustifyCenter"==e)if(f=a.selection.getNode(),f.nodeName=="IMG")e=e.substr(7).toLowerCase(),
c="align"+e,e=a.dom.getParent(f,"dl.wp-caption"),d=a.dom.getParent(f,"div.mceTemp"),e&&d?(f=a.dom.hasClass(e,c)?"alignnone":c,e.className=e.className.replace(/align[^ '"]+\s?/g,""),a.dom.addClass(e,f),f=="aligncenter"?a.dom.addClass(d,"mceIEcenter"):a.dom.removeClass(d,"mceIEcenter"),b.terminate=!0,a.execCommand("mceRepaint")):a.dom.hasClass(f,c)?a.dom.addClass(f,"alignnone"):a.dom.removeClass(f,"alignnone")});a.onInit.add(function(a){a.onNodeChange.add(function(a,d,c){var b;if(c.nodeName=="IMG")b=
a.dom.getParent(c,"dl.wp-caption");else if(c.nodeName=="DIV"&&a.dom.hasClass(c,"mceTemp"))b=c.firstChild,a.dom.hasClass(b,"wp-caption")||(b=!1);b&&(a.dom.hasClass(b,"alignleft")?d.setActive("justifyleft",1):a.dom.hasClass(b,"alignright")?d.setActive("justifyright",1):a.dom.hasClass(b,"aligncenter")&&d.setActive("justifycenter",1))});a.onBeforeSetContent.add(function(a,b){if(b.content)b.content=b.content.replace(/<p>\s*<(p|div|ul|ol|dl|table|blockquote|h[1-6]|fieldset|pre|address)( [^>]*)?>/gi,"<$1$2>"),
b.content=b.content.replace(/<\/(p|div|ul|ol|dl|table|blockquote|h[1-6]|fieldset|pre|address)>\s*<\/p>/gi,"</$1>")})});"undefined"!=typeof wpWordCount&&a.onKeyUp.add(function(a,d){if(d.keyCode!=b)(13==d.keyCode||8==b||46==b)&&wpWordCount.wc(a.getContent({format:"raw"})),b=d.keyCode});a.onSaveContent.add(function(a,b){if(typeof switchEditors=="object")b.content=a.isHidden()?b.element.value:switchEditors.pre_wpautop(b.content)});c._handleMoreBreak(a,d);a.addShortcut("alt+shift+c",a.getLang("justifycenter_desc"),
"JustifyCenter");a.addShortcut("alt+shift+r",a.getLang("justifyright_desc"),"JustifyRight");a.addShortcut("alt+shift+l",a.getLang("justifyleft_desc"),"JustifyLeft");a.addShortcut("alt+shift+j",a.getLang("justifyfull_desc"),"JustifyFull");a.addShortcut("alt+shift+q",a.getLang("blockquote_desc"),"mceBlockQuote");a.addShortcut("alt+shift+u",a.getLang("bullist_desc"),"InsertUnorderedList");a.addShortcut("alt+shift+o",a.getLang("numlist_desc"),"InsertOrderedList");a.addShortcut("alt+shift+d",a.getLang("striketrough_desc"),
"Strikethrough");a.addShortcut("alt+shift+n",a.getLang("spellchecker.desc"),"mceSpellCheck");a.addShortcut("alt+shift+a",a.getLang("link_desc"),"mceLink");a.addShortcut("alt+shift+s",a.getLang("unlink_desc"),"unlink");a.addShortcut("alt+shift+m",a.getLang("image_desc"),"mceImage");a.addShortcut("alt+shift+g",a.getLang("fullscreen.desc"),"mceFullScreen");a.addShortcut("alt+shift+z",a.getLang("wp_adv_desc"),"WP_Adv");a.addShortcut("alt+shift+h",a.getLang("help_desc"),"WP_Help");a.addShortcut("alt+shift+t",
a.getLang("wp_more_desc"),"WP_More");a.addShortcut("alt+shift+p",a.getLang("wp_page_desc"),"WP_Page");a.addShortcut("ctrl+s",a.getLang("save_desc"),function(){"function"==typeof autosave&&autosave()});tinymce.isWebKit&&(a.addShortcut("alt+shift+b",a.getLang("bold_desc"),"Bold"),a.addShortcut("alt+shift+i",a.getLang("italic_desc"),"Italic"));a.onInit.add(function(a){tinymce.dom.Event.add(a.getWin(),"scroll",function(){a.plugins.wordpress._hideButtons()});tinymce.dom.Event.add(a.getBody(),"dragstart",
function(){a.plugins.wordpress._hideButtons()})});a.onBeforeExecCommand.add(function(a){a.plugins.wordpress._hideButtons()});a.onSaveContent.add(function(a){a.plugins.wordpress._hideButtons()});a.onMouseDown.add(function(a,b){b.target.nodeName!="IMG"&&a.plugins.wordpress._hideButtons()})},getInfo:function(){return{longname:"WordPress Plugin",author:"WordPress",authorurl:"http://wordpress.org",infourl:"http://wordpress.org",version:"3.0"}},_setEmbed:function(a){return a.replace(/\[embed\]([\s\S]+?)\[\/embed\][\s\u00a0]*/g,
function(a,c){return'<img width="300" height="200" src="'+tinymce.baseURL+'/plugins/wordpress/img/trans.gif" class="wp-oembed mceItemNoResize" alt="'+c+'" title="'+c+'" />'})},_getEmbed:function(a){return a.replace(/<img[^>]+>/g,function(a){if(a.indexOf('class="wp-oembed')!=-1){var c=a.match(/alt="([^\"]+)"/);c[1]&&(a="[embed]"+c[1]+"[/embed]")}return a})},_showButtons:function(a,d){var c=tinyMCE.activeEditor,g,i,b,k=tinymce.DOM;b=c.dom.getViewPort(c.getWin());g=k.getPos(c.getContentAreaContainer());
i=c.dom.getPos(a);k.setStyles(d,{top:Math.max(i.y-b.y,0)+g.y+5+"px",left:Math.max(i.x-b.x,0)+g.x+5+"px",display:"block"});this.mceTout&&clearTimeout(this.mceTout);this.mceTout=setTimeout(function(){c.plugins.wordpress._hideButtons()},5E3)},_hideButtons:function(){if(this.mceTout)document.getElementById("wp_editbtns")&&tinymce.DOM.hide("wp_editbtns"),document.getElementById("wp_gallerybtns")&&tinymce.DOM.hide("wp_gallerybtns"),clearTimeout(this.mceTout),this.mceTout=0},_resizeIframe:function(a,d,c){d=
a.getContentAreaContainer().firstChild;h.setStyle(d,"height",d.clientHeight+c);a.theme.deltaHeight+=c},_handleMoreBreak:function(a,d){var c,g;c='<img src="'+d+'/img/trans.gif" alt="$1" class="mceWPmore mceItemNoResize" title="'+a.getLang("wordpress.wp_more_alt")+'" />';g='<img src="'+d+'/img/trans.gif" class="mceWPnextpage mceItemNoResize" title="'+a.getLang("wordpress.wp_page_alt")+'" />';a.onInit.add(function(){a.dom.loadCSS(d+"/css/content.css")});a.onPostRender.add(function(){a.theme.onResolveName&&
a.theme.onResolveName.add(function(c,b){if(b.node.nodeName=="IMG"){if(a.dom.hasClass(b.node,"mceWPmore"))b.name="wpmore";if(a.dom.hasClass(b.node,"mceWPnextpage"))b.name="wppage"}})});a.onBeforeSetContent.add(function(a,b){if(b.content)b.content=b.content.replace(/<\!--more(.*?)--\>/g,c),b.content=b.content.replace(/<\!--nextpage--\>/g,g)});a.onPostProcess.add(function(a,b){if(b.get)b.content=b.content.replace(/<img[^>]+>/g,function(a){if(a.indexOf('class="mceWPmore')!==-1)var b,a="<\!--more"+((b=
a.match(/alt="(.*?)"/))?b[1]:"")+"--\>";a.indexOf('class="mceWPnextpage')!==-1&&(a="<\!--nextpage--\>");return a})});a.onNodeChange.add(function(a,b,c){b.setActive("wp_page",c.nodeName==="IMG"&&a.dom.hasClass(c,"mceWPnextpage"));b.setActive("wp_more",c.nodeName==="IMG"&&a.dom.hasClass(c,"mceWPmore"))})}});tinymce.PluginManager.add("wordpress",tinymce.plugins.WordPress)})();
